<!doctype html>
<html>
<title>drawing to canvas code</title>
<meta charset="utf-8" />

<!-- Copyright 2013 Martyn Peck (mwp@mwpnet.com) -->

<!--    This file is part of drawing-to-code.										-->
<!--																				-->
<!--    drawing-to-code is free software: you can redistribute it and/or modify		-->
<!--    it under the terms of the GNU General Public License as published by		-->
<!--    the Free Software Foundation, either version 3 of the License, or			-->
<!--    (at your option) any later version.											-->
<!--																				-->
<!--    drawing-to-code is distributed in the hope that it will be useful,			-->
<!--    but WITHOUT ANY WARRANTY; without even the implied warranty of				-->
<!--    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the				-->
<!--    GNU General Public License for more details.								-->
<!--																				-->
<!--    You should have received a copy of the GNU General Public License			-->
<!--    along with drawing-to-code.  If not, see <http://www.gnu.org/licenses/>.	-->


<script type="text/javascript" src="jquery/jquery.min.js" ></script>

<script type="text/javascript" src="javascript/geometry.js"></script>
<script type="text/javascript" src="javascript/buttons.js"></script>
<script type="text/javascript" src="javascript/parseCode.js"></script>
<script type="text/javascript" src="javascript/drawPathHandles.js"></script>
<script type="text/javascript" src="javascript/mouseEvents.js"></script>
<script type="text/javascript" src="javascript/liveCanvas.js"></script>
<script type="text/javascript" src="javascript/moveHandle.js"></script>
<script type="text/javascript" src="javascript/addPathCommands.js"></script>
<script type="text/javascript" src="javascript/linePropEvents.js"></script>
<script type="text/javascript" src="javascript/fillStroke.js"></script>
<script type="text/javascript" src="javascript/fontPropEvents.js"></script>

<script src="thirdParty/acorn.js"></script>
<script src="thirdParty/util/walk.js"></script>

<script>

window.onload=function() {
	init();
	
	tabSelect("drawItem");
	subTabSelect('lineStyle');
};
</script>

<style>
body {
	background: grey;
}

canvas {
	background: white;
}

#buttons {
	width: 74px;
	display: inline;
	float: left;
}
#buttons canvas {
	border-style: outset;
	border-width:medium;
	border-color: black;
}

#columns{
	clear:right;
	width: 100%;
}
#centerCol {
	width: 50%;
	display: inline;
	float: left;
}

#rightCol {
	width: 50%;
	display: inline;
	float: left;
}

#showHide #showHandls {
	display: none;
}

#showHide #hideHandls {
	display: block;
}

#errorbox {
	font-family: monospace;
	background: #ffbbbb;
}

#codeArea {
	border: 1px solid black;
}

#precode,#code,#postcode {
	font-family: monospace;
	border: none;
}

#code {
	color: #000000;
	height: 400px;
	width: 100%;
}

#precode,#postcode {
	color: #888888;
}

#headerText {
	background: #dddddd;
	width: 90%;
	margin-left: 5%;
}

.lineStyleBox{
	width:75px;
	height:50px;
	background: #ffffff;
}

.tab {
	float:left;
	border:solid;
}
.panels{
	clear: both;
	border: solid;
	border-top: none;
	//height: 300px;
	clear: both;
}

.subTab {
	float:left;
	border:solid;
}
.subPanel{
	clear: both;
	border: solid;
	border-top: none;
	//height: 300px;
	clear: both;
}

</style>

</head>
<body>
<div id="headerText">
<h1>Drawing to Code</h1>
<p>Basic vector drawing program, that give you back the javascript code needed to recreate the image drawn.
It's designed so that you can paste code in from elsewhere and edit it here.</p>
<p>There are some caveats when using this program:</p>
	<ul>
	<li>First and foremost this is still <i><b>alpha code</b></i>. So expect things to break.</li>
	<li>The code parsing that the program uses is <i>very primitive</i> and can be easily confused and break.</li>
	<li>Since the drawing part manipulates the arguments of the code itself, the path methods can only have literal numerical values. No variables.</li>
	<li>Currently the program does not handle transformations properly. It turns out this is exceptionally complicated, and will have to wait until the next version.</li>
	</ul>
</div>

<div id="columns">
<div id="centerCol">
<canvas id="editDrawing" width="400" height="400" style="border:1px solid #d3d3d3;">

Your browser does not support the HTML5 canvas tag.</canvas>
		<div id="showHide">
			<button id="showHandls">show control handles</button>
			<button id="hideHandls">hide control handles</button>
		</div>
	</div>
<div id="rightCol">
		<form onsubmit="return onExecuteCode()">
			<p id="errorBox"></p>
			<div id="codeArea">
				<textarea id="code">
function draw(context){
	context.beginPath();

	context.lineWidth=5;
	context.strokeStyle="black";
	context.stroke();
}
</textarea>
			</div>

			<button id="executeCode">execute code</button>
		</form>
	</div>
</div>
	
<div id="tabPanelGroup">
<div id="drawItemTab" class="tab" onclick="tabSelect('drawItem')">Draw Item</div>
<div id="pathTab" class="tab" onclick="tabSelect('path')">Path Elements</div>
<div id="styleTab" class="tab" onclick="tabSelect('style')">Style</div>
</div>

<div id="drawItemPanel" class="panels">
<input type="checkbox" id="addFill" onclick="onClickFill()">fill()<br>
<input type="checkbox" id="addStroke" onclick="onClickStroke()">stroke()<br>
<button id="fillRectButton" onclick="addFillRect()">fillRect</button><br>
<button id="strokeRectButton" onclick="addStrokeRect()">strokeRect</button><br>
<button id="fillTextButton" onclick="addFillText()">fillText</button><br>
<button id="strokeTextButton" onclick="addStrokeText()">strokeText</button><br>

</div>



<div id="pathPanel" class="panels">
<button id="beginPathButton" onclick="addBeginPath()">BeginPath</button>
<canvas id="moveToButton" width="64" height="64" title="moveTo()" onclick="onClickMoveTo()"></canvas>
<canvas id="lineToButton" width="64" height="64" title="lineTo()" onclick="onClickLineTo()"></canvas>
<canvas id="bezierCurveToButton" width="64" height="64" title="bezierCurveTo()" onclick="onClickBezierCurveTo()"></canvas>
<canvas id="quadraticCurveToButton" width="64" height="64" title="quadraticCurveTo()" onclick="onClickQuadraticCurveTo()"></canvas>
<canvas id="arcToButton" width="64" height="64" title="arcTo()" onclick="onClickArcTo()"></canvas>
<canvas id="arcButton" width="64" height="64" title="arc()" onclick="onClickArc()"></canvas>
<canvas id="closePathButton" width="64" height="64" title="closePath()" onclick="onClickClosePath()"></canvas>
</div>


<div id="stylePanel" class="panels">
<div id="subTabPanelGroup">

<div id="lineStyleTab" class="subTab" onclick="subTabSelect('lineStyle')">Line Style</div>
<div id="colorStyleTab" class="subTab" onclick="subTabSelect('colorStyle')">Color</div>
<div id="fontStyleTab" class="subTab" onclick="subTabSelect('fontStyle')">Font</div>
<div id="shadowStyleTab" class="subTab" onclick="subTabSelect('shadowStyle')">Shadow</div>
</div>

<!--  line properties -->
<div id="lineStylePanel" class="subPanel">
<table>
<tr><th>Line Width</th><td></td><td colspan=4><button id="plusLineWidth" onclick="incDecWidth(1)">+</button><input id="lineWidthInput" type="text" onchange="changeLineWidth()"><button id="minusLineWidth" onclick="incDecWidth(-1)">-</button></td></tr>
<tr><th>Line Cap</th>
<td><div class = "lineStyleBox" id="lineCapNone" onclick="clearLineStyleLine('lineCap')">none</div></td>
<td><canvas class = "lineStyleBox" id="lineCapButt" width=75 height=50 title="line cap butt" onclick="generalLineStyleCode('lineCap','butt',true)"></canvas></td>
<td><canvas class = "lineStyleBox" id="lineCapRound" width=75 height=50 title="line cap round" onclick="generalLineStyleCode('lineCap','round',true)"></canvas></td>
<td><canvas class = "lineStyleBox" id="lineCapsquare" width=75 height=50 title="line cap square" onclick="generalLineStyleCode('lineCap','square',true)"></canvas></td>
</tr>
<tr><th>Line Join</th>
<td><div class = "lineStyleBox" id="lineJoinNone" onclick="clearLineStyleLine('lineJoin')">none</div></td>
<td><canvas class = "lineStyleBox" id="lineJoinBevel" width=75 height=50 title="line cap bevel" onclick="generalLineStyleCode('lineJoin','bevel',true)"></canvas></td>
<td><canvas class = "lineStyleBox" id="lineJoinRound" width=75 height=50 title="line cap round" onclick="generalLineStyleCode('lineJoin','round',true)"></canvas></td>
<td><canvas class = "lineStyleBox" id="lineJoinMiter" width=75 height=50 title="line cap miter" onclick="generalLineStyleCode('lineJoin','miter',true)"></canvas></td>
</tr>
<tr><th>Miter Limit</th><td><div class = "lineStyleBox" id="miterLimitNone" onclick="clearLineStyleLine('miterLimit')">none</div></td>
<td colspan=4><button id="plusMiterLimit" onclick="incDecMiter(1)">+</button><input id="miterLimitInput" type="text" value=10 onchange="changeMiterLimit()"><button id="minusMiterLimit" onclick="incDecMiter(-1)">-</button></td></tr>
</table>
</div>

<!--  color properties -->
<div id="colorStylePanel" class="subPanel">
<table>
<tr><th>Color</th><td><input type="text" name="color"></td></tr>
<tr><th>Red</th><td><canvas class = "colorBars" id="colorRed" width=200 height=20 title="Red Color" onclick="generalFontStyleCode('textAlignStyleBox','left',true)"></canvas></td></tr>
<tr><th>Green</th><td><canvas class = "colorBars" id="colorGreen" width=200 height=20 title="Green Color" onclick="generalFontStyleCode('textAlignStyleBox','left',true)"></canvas></td></tr>
<tr><th>Blue</th><td><canvas class = "colorBars" id="colorBlue" width=200 height=20 title="Blue Color" onclick="generalFontStyleCode('textAlignStyleBox','left',true)"></canvas></td></tr>
</table>
</div>

<!--  font properties -->
<div id="fontStylePanel" class="subPanel">
<table>
<tr><th>Font</th><td><input type="text" name="font"></td></tr>
<tr><th>Text Alignment</th><td>
	<input type="radio" name="textAlign" value="left"><canvas class = "textAlignStyleBox" id="textAlignLeft" width=200 height=20 title="Text Alignment Left" onclick="generalFontStyleCode('textAlignStyleBox','left',true)"></canvas>Left<br>
	<input type="radio" name="textAlign" value="center"><canvas class = "textAlignStyleBox" id="textAlignCenter" width=200 height=20 title="Text Alignment Center" onclick="generalFontStyleCode('textAlignStyleBox','center',true)"></canvas>Center<br>
	<input type="radio" name="textAlign" value="right"><canvas class = "textAlignStyleBox" id="textAlignRight" width=200 height=20 title="Text Alignment Right" onclick="generalFontStyleCode('textAlignStyleBox','right',true)"></canvas>Right<br>
	<input type="radio" name="textAlign" value="start"><canvas class = "textAlignStyleBox" id="textAlignStart" width=200 height=20 title="Text Alignment Start" onclick="generalFontStyleCode('textAlignStyleBox','start',true)"></canvas>Start<br>
	<input type="radio" name="textAlign" value="end"><canvas class = "textAlignStyleBox" id="textAlignEnd" width=200 height=20 title="Text Alignment End" onclick="generalFontStyleCode('textAlignStyleBox','end',true)"></canvas>End<br>
	</td></tr>
<tr><th>BaseLine</th><td>
	<input type="radio" name="textBaseline" value="alphabetic"><canvas class = "textBaselineStyleBox" id="textBaselineStyleBoxAlphabetic" width=200 height=40 title="Text BaseLine Alphabetic" onclick="generalFontStyleCode('textAlignStyleBox','left',true)"></canvas>Alphabetic<br>
	<input type="radio" name="textBaseline" value="top"><canvas class = "textBaselineStyleBox" id="textBaselineStyleBoxTop" width=200 height=40 title="Text BaseLine Top" onclick="generalFontStyleCode('textAlignStyleBox','left',true)"></canvas>Top<br>
	<input type="radio" name="textBaseline" value="hanging"><canvas class = "textBaselineStyleBox" id="textBaselineStyleBoxHanging" width=200 height=40 title="Text BaseLine Hanging" onclick="generalFontStyleCode('textAlignStyleBox','left',true)"></canvas>Hanging<br>
	<input type="radio" name="textBaseline" value="middle"><canvas class = "textBaselineStyleBox" id="textBaselineStyleBoxMiddle" width=200 height=40 title="Text BaseLine Middle" onclick="generalFontStyleCode('textAlignStyleBox','left',true)"></canvas>Middle<br>
	<input type="radio" name="textBaseline" value="ideographic"><canvas class = "textBaselineStyleBox" id="textBaselineStyleBoxIdeographic" width=200 height=40 title="Text BaseLine Ideographic" onclick="generalFontStyleCode('textAlignStyleBox','left',true)"></canvas>Ideographic<br>
	<input type="radio" name="textBaseline" value="bottom"><canvas class = "textBaselineStyleBox" id="textAligtextBaselineStyleBoxBottom" width=200 height=40 title="Text BaseLine Bottom" onclick="generalFontStyleCode('textAlignStyleBox','left',true)"></canvas>Bottom<br>
	</td></tr>
</table>
</div>

<div id="shadowStylePanel" class="subPanel">
<!--  shadow properties -->
<table>
<tr><th>Shadow Color</th><td><input type="text" name="shadow"></td></tr>
<tr><th>Red</th><td><canvas class = "colorBars" id="colorRed" width=200 height=20 title="Red Color" onclick="generalFontStyleCode('textAlignStyleBox','left',true)"></canvas></td></tr>
<tr><th>Green</th><td><canvas class = "colorBars" id="colorRed" width=200 height=20 title="Red Color" onclick="generalFontStyleCode('textAlignStyleBox','left',true)"></canvas></td></tr>
<tr><th>Blue</th><td><canvas class = "colorBars" id="colorRed" width=200 height=20 title="Red Color" onclick="generalFontStyleCode('textAlignStyleBox','left',true)"></canvas></td></tr>
<tr><th>Shadow off set X</th><td><button id="plusLineWidth" onclick="incDecWidth(1)">+</button><input id="lineWidthInput" type="text" onchange="changeLineWidth()"><button id="minusLineWidth" onclick="incDecWidth(-1)">-</button></td></tr>
<tr><th>Shadow off set Y</th><td><button id="plusLineWidth" onclick="incDecWidth(1)">+</button><input id="lineWidthInput" type="text" onchange="changeLineWidth()"><button id="minusLineWidth" onclick="incDecWidth(-1)">-</button></td></tr>
<tr><th>Shadow blur</th><td><button id="plusLineWidth" onclick="incDecWidth(1)">+</button><input id="lineWidthInput" type="text" onchange="changeLineWidth()"><button id="minusLineWidth" onclick="incDecWidth(-1)">-</button><canvas width=200 height=40 title="Red Color"></canvas></td></tr>
</table>
</div>

</div>
</body>

<script>
var tabId = {
		drawItem: {
				panel: document.getElementById("drawItemPanel"),
				tab: document.getElementById("drawItemTab")
			},
		path: {
				panel: document.getElementById("pathPanel"),
				tab: document.getElementById("pathTab")
			},
		style: {
			panel: document.getElementById("stylePanel"),
			tab: document.getElementById("styleTab")
		}
}

function tabSelect(idToOpen){
	for (var idLoop in tabId) {
		if( idLoop == idToOpen){
			continue;
		}
		tabId[idLoop].panel.style.display="none";
		tabId[idLoop].tab.style.border="solid";
	}
	tabId[idToOpen].panel.style.display="block";
	tabId[idToOpen].tab.style.borderBottom="none";
}


var subTabId = {
		lineStyle: {
			panel: document.getElementById("lineStylePanel"),
			tab: document.getElementById("lineStyleTab")
		},
		fontStyle: {
			panel: document.getElementById("fontStylePanel"),
			tab: document.getElementById("fontStyleTab")
		},
		colorStyle: {
			panel: document.getElementById("colorStylePanel"),
			tab: document.getElementById("colorStyleTab")
		},
		shadowStyle: {
			panel: document.getElementById("shadowStylePanel"),
			tab: document.getElementById("shadowStyleTab")
		}
}

function subTabSelect(idToOpen){
	for (var idLoop in subTabId) {
		if( idLoop == idToOpen){
			continue;
		}
		subTabId[idLoop].panel.style.display="none";
		subTabId[idLoop].tab.style.border="solid";
	}
	subTabId[idToOpen].panel.style.display="block";
	subTabId[idToOpen].tab.style.borderBottom="none";
}
</script>

</html>
